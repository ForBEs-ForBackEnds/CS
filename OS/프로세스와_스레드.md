### **목차**
- [프로세스](#프로세스)
    - [프로세스 구조](#프로세스-구조)
            - [코드](#코드)
            - [힙](#힙)
            - [데이터](#데이터)
            - [스택](#스택)
- [스레드](#스레드)
        - [단일 스레드와 멀티 스레드](#단일-스레드와-멀티-스레드)
- [참고 자료](#참고-자료)

# 프로세스

우리는 인텔리제이, VS Code 같은 IDE를 실행할 때, 화면에 있는 아이콘을 클릭한다.
이 때, 우리가 실행하는 것은 **프로그램**이다. 프로그램은 휘발되지 않고, 영구적으로 저장되는
하드 디스크에 저장되어 있는 데이터 모음이다. 프로그램 자체는 소프트웨어로서 어떠한 능력을
발휘하지 않는다. 우리가 IDE를 통해 코딩을 하면서 다양한 기능들을 사용할 수 있는 것은
프로그램이 아닌 **프로세스**이다.

프로세스는 프로그램을 구성하는 여러 코드들을 CPU(코어)가 수행할 수 있도록 메모리를
할당받으며, **운영체제 안에서 실행되는 프로그램을 프로세스**라고 한다.

![ryySJqf.png|536](https://i.imgur.com/ryySJqf.png)

이처럼 하나의 운영체제 안에 여러 프로그램을 실행했을 때, 각각이 프로세스 단위로 존재하게 된다.
그림에서 알 수 있듯이, 각 프로세스는 고유한 메모리 공간을 갖고 있다.
중요한건 프로세스 별로 독립된 메모리 공간을 가지며, 다른 프로세스의 메모리에 접근할 수 없다. (운영체제의 역할 중 하나)
이것이 시사하는 바는 다음과 같다. 그림에서 유튜브 뮤직 프로세스에 문제가 생기더라도
인텔리제이 프로세스에는 영향을 주지 않는다. 이처럼 각 프로세스는 서로에게 영향을 주지 않고
독립적인 생명주기를 갖는다. 물론 이건 당연하게 되는 것이 아니라 운영체제의 도움 덕분이다.

## 프로세스 구조
#### 코드
프로그램이 실행되려면 먼저 프로세스 상태가 되어야 한다. 그리고 프로그램을 구성하는 코드들을
순차적으로 실행함으로써 비로소 구현한 기능들이 동작한다. 이 때, **프로그램을 구성하는 코드들이 저장되는 공간이 코드 영역이다.**
#### 힙
자바에서 힙 메모리는 인스턴스가 생성됐을 때, 해당 인스턴스의 주소 값이 저장되는 공간이다.
프로세스의 힙 메모리도 이와 마찬가지로 동적으로 생성되어 할당되는 주소 값이 저장되는 공간이다.
#### 데이터
코드에서 전역 변수 및 정적 변수가 저장되는 메모리 공간이다. 해당 그림에서 기타에 해당한다.
#### 스택
메서드(함수)를 호출했을 때, 생성되는 지역 변수와 반환되는 주소가 저장되는 공간으로 이는 프로세스가 아닌 스레드의 영역에 속한다. (이후 그림으로 다시 소개하겠다.)

프로세스를 구성하는 메모리 영역의 이름과 특징을 확인해보았다. 그런데 생각보다 이들의 역할이 이름과 잘 매칭이 되고 있다.

**코드는 말 그대로 프로그램을 구성하는 코드를 저장한다. 힙은 동적으로 할당되는 주소 값을 저장한다. 데이터는 코드 실행에 필요한 데이터에 해당하는 전역 변수 및 정적 변수를 저장한다.**

# 스레드

프로세스의 메모리 영역을 살펴보면서 스택 메모리는 프로세스가 아닌 스레드에 속한다고 하였다.
그말은 **스레드라는 것은 프로세스 내에 속하는 존재라는 것이다.**

우리가 작성한 코드 혹은 특정 프로그램을 실행함으로써 코드가 실행되는 기본적인 단위가
바로 **스레드**이다. 여기서 혼동하면 안되는 건 **실제 코드를 실행하는 실질적인 주체는 CPU(코어)라는 것이다! CPU는 프로세스 내에 존재하는 스레드의 코드를 실행하는 것이다.**

하나의 프로세스에는 여러 스레드가 존재할 수 있으며, 여러 스레드들은 프로세스가 갖고 있는 메모리 영역(코드, 힙, 데이터)을 공유하며 사용할 수 있다.

프로세스를 만드는 것과 스레드를 만드는 것 중 어떤 것이 더 많은 비용을 소모할까?
프로세스는 기본적으로 코드, 힙, 데이터가 필요하다. 하지만 스레드는 각 스레드별로 존재하는 스택 메모리만 있으면 된다. 따라서 프로세스보다 스레드를 생성하는 것이 더 간편하고 가벼우며,
하나의 프로세스에는 여러 스레드가 존재할 수 있다.

![](https://i.imgur.com/9yTQICb.png)

스레드들은 자신이 속한 프로세스의 메모리 영역을 공유할 수 있다. (코드, 힙, 데이터)
**하지만 각 스레드별로 갖고 있는 스택 메모리는 서로 공유할 수 없다.**

### 단일 스레드와 멀티 스레드

우리가 작성한 자바 클래스의 main 메서드를 실행하면, CPU가 하나의 스레드를 통해 코드를 순차적으로 실행할 것이다. 그러나 스레드가 두 개라면? 두 개의 스레드를 사용해서 코드를 실행할 것이다.

스레드가 많다면 그만큼 프로그램에 작성된 코드를 한 번에 실행할 수 있는 범위가 넓어지는 것이다. 이를 잘 활용하면 하나의 프로그램에서 여러 기능들을 수행할 수 있다.

현재 이 글을 작성하는데 사용하고 있는 **옵시디언**도 단순 글을 작성하는 것뿐만 아니라
여러 플러그인들이 동작하고 있다. 이 또한 옵시디언이라는 프로세스에 여러 스레드가
존재하기에 가능한 것이다.

강의에서는 유튜브를 멀티 스레드의 예시로 소개하였다.

![EwPlo1b.png|611](https://i.imgur.com/EwPlo1b.png)

우리는 유튜브 숏츠 영상을 보면서 댓글을 달 수도 있다.
이 때, **유튜브 숏츠를 재생시키는 스레드와 댓글을 작성할 수 있는 스레드**가 존재하는 것이다.

# 참고 자료
1. [인프런 김영한 자바 고급 1편](https://www.inflearn.com/course/%EA%B9%80%EC%98%81%ED%95%9C%EC%9D%98-%EC%8B%A4%EC%A0%84-%EC%9E%90%EB%B0%94-%EA%B3%A0%EA%B8%89-1/dashboard)
